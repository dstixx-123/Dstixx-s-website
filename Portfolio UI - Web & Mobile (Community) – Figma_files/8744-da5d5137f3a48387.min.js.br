"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ab40a0f5-2168-5bb5-9b17-a75b6929be41")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[8744],{900878:(e,t,a)=>{a.d(t,{E:()=>o,P:()=>c});var n=a(574724),l=a(852800);function r(e,t){let a={},n=e.getVariableConsumptionMap();if(Object.keys(n).length>0)for(let[r,o]of Object.entries(n))if((null==o?void 0:o.isMixed)||(null==o?void 0:o.type)!==l.Z_n.ALIAS){if(!(null==o?void 0:o.isMixed)&&(null==o?void 0:o.type)===l.Z_n.EXPRESSION)for(let n of function e(t){let a=[];for(let n of t.value.expressionArguments)n.type===l.Z_n.ALIAS?a.push(n.value):n.type===l.Z_n.EXPRESSION&&a.push(...e(n));return a}(o))i(n,r,e,t,a)}else{let n=null==o?void 0:o.value;a[n]||i(n,r,e,t,a)}for(let n of e.childrenNodes)Object.assign(a,r(n,t));return a}function i(e,t,a,n,l){var r,i,o;if(!l[e]){l[e]={nodesUsed:{}};let t=null==(r=n.get(e))?void 0:r.name;t&&(l[e].name=t);let a=null==(i=n.get(e))?void 0:i.description;a&&(l[e].description=a);let c=null==(o=n.get(e))?void 0:o.resolvedType;c&&(l[e].resolvedType=c)}return l[e].nodesUsed[a.guid]||(l[e].nodesUsed[a.guid]={nodeName:a.name,fields:[]}),l[e].nodesUsed[a.guid].fields.push(t),l}function o(e,t,a=new Map){let n=function(e,t=new Map,a=!1){if(a)return r(e.getRoot(),t);let n=e.getCurrentPage();return null===n?{}:r(n,t)}(e,t);if(a.size>0)for(let[e,t]of a)n[e]||(n[e]={nodesUsed:{}},n[e].name=t.name,n[e].description=t.description,n[e].resolvedType=t.resolvedType,n[e].priority="LOW");return function(e){let t="";for(let[a,n]of Object.entries(e)){if(t+=`${a} has name "${n.name}", resolvedType "${n.resolvedType}"`,n.description&&(t+=`, description "${n.description.slice(0,100)}"`),n.priority?t+=`, priority "${n.priority}"`:t+=', priority "NORMAL"',Object.keys(n.nodesUsed).length>0)for(let[e,{nodeName:a,fields:l}]of(t+=", and is used in ",Object.entries(n.nodesUsed)))t+=`node ${a} with fields ${l.join(", ")}`;t+="\n"}return t}(n)}async function c(e,t,a=.5){let l=[];for(let[t,a]of e)a.description?l.push(`${a.name}: ${a.description}`):l.push(a.name);let r=(await n.Ay.openai.computeEmbeddings({model:"text-embedding-3-small",input:[t,...l],use_cache:!0})).data.map(e=>e.embedding),i=r[0],o=new Map,c=Array.from(e);for(let e=1;e<r.length;e++)if(function(e,t){return e.reduce((e,a,n)=>e+a*t[n],0)/(Math.sqrt(e.reduce((e,t)=>e+t*t,0))*Math.sqrt(t.reduce((e,t)=>e+t*t,0)))}(i,r[e])>a){let[t,a]=c[e-1];o.set(t,a)}return o}},511787:(e,t,a)=>{a.d(t,{f:()=>b});var n=a(411855),l=a(153234),r=a(572206),i=a(268537),o=a(574176),c=a(318812),d=a(720488),u=a(704762),s=a(820396),m=a(675357),p=a(50275),v=a(501191);function b({resolvedTypes:e,recordingKey:t}){let{showing:a,toggle:i,hide:s}=(0,c.B)("expression-builder-create-variable"),m=n.useRef(null),b=l.rf(l.Pt(t,"createVariableDropdown"),"click",n.useCallback(()=>{1===e.length?E(e[0]):i()},[e,i])),[g,h]=n.useState(!1),_=n.useRef(null),E=e=>{var t;let a=null==(t=m.current)?void 0:t.getBoundingClientRect();a&&(_.current={initialPosition:new r.Mi(a.left,a.top),resolvedType:e},h(!0))},y=()=>{h(!1)};return n.createElement(n.Fragment,null,n.createElement("button",{ref:m,className:p.ZS,onClick:b},n.createElement(o.B,{svg:v.A})),g&&(g&&_.current?n.createElement(u.IU,{initialPosition:_.current.initialPosition,resolvedType:_.current.resolvedType,onCreateVariable:y,onClose:y}):null),a&&m.current&&n.createElement(d.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:m.current.getBoundingClientRect()},e.map(e=>n.createElement(f,{key:e,resolvedType:e,onClose:s,showCreationModal:E,recordingKey:t}))))}function f({resolvedType:e,onClose:t,showCreationModal:a,recordingKey:r}){let o=(0,m.F)(e),c=l.rf(l.Pt(r,"createVariableOption",o.name),"click",n.useCallback(()=>{a(e),t()},[t,e,a]));return n.createElement(i.W.Option,{className:p.Fs,onClick:c},n.createElement(s.i,{type:e,showTooltip:!1}),o.name)}},704762:(e,t,a)=>{a.d(t,{Ty:()=>F,iG:()=>W,IU:()=>K,C_:()=>Z});var n=a(411855),l=a(188507),r=a(421757),i=a(89865),o=a.n(i),c=a(935283),d=a(91408),u=a(320063),s=a(572174),m=a(153234),p=a(776621),v=a(286640),b=a(946689),f=a(659838),g=a(939863),h=a(175290),_=a(632430),E=a(877953),y=a(852800),C=a(662531),I=a(869156),T=a(318812),S=a(173454),L=a(498606),V=a(7959),w=a(538697),A=a(761334),x=a(746806),M=a(894742),N=a(282263),R=a(564092),U=a(15270),O=a(656963),k=a(860168);let P="variable_create_modal--input--d-tVA";var $=a(424148);let B=2*(0,d.jz)(k.dGl),W=304;function K({initialPosition:e,initialValue:t,resolvedType:a,onCreateVariable:l,onClose:r}){(0,A.NF)({resolvedType:a});let{onCreateVariableSubmit:i}=Z({onCreateVariable:l,onClose:r});return n.createElement(j,{initialPosition:e,initialValue:t,resolvedType:a,onCreateVariableSubmit:i,onClose:r,recordingKey:"createVariableModal"})}function Z({onCreateVariable:e,onClose:t}){return{onCreateVariableSubmit:function({varSetID:a,varName:n,varValue:l}){if(!y.CWU.isValidVariableName(n,a)){(0,p.x1)("variables","Attempted to submit variable name that is invalid",{varName:n,_varSetID:a});return}C.l7.user("create-variable",()=>{let t=a??y.CWU.createVariableSet((0,g.t)("variables.variable_collection"),y.G6k.AUTOMATIC_FIRST_COLLECTION),r=y.CWU.createVariable(n,t,l,y.HS4.VARIABLE_PICKER),i=y.CWU.getLocalVariableInfo(r);(0,c.B1)(i,`variable with id ${r} not found`),e((0,S.kz)(i))}),t()}}}function j({initialPosition:e,initialValue:t,resolvedType:a,recordingKey:l,onCreateVariableSubmit:r,onClose:i}){return n.createElement(x.vx,{title:n.createElement("div",{className:"variable_create_modal--staticTitle--HS1IC"},n.createElement(g.Tx,{id:"variables.create_modal.title"})),initialPosition:e,initialWidth:W,onClose:i},n.createElement(F,{resolvedType:a,initialValue:t,recordingKey:m.Pt(l,"createVariableForm"),onSubmit:r}))}function F({resolvedType:e,initialValue:t,recordingKey:a,onSubmit:i}){let o=(0,l.wA)(),c=(0,I.yp)(),p=(0,n.useRef)(null),[C,T]=(0,v.Vc)("last-used-variable-set-bottoms-up",c.length>0?c[0].node_id:null),S=(0,n.useMemo)(()=>{let e=c.find(e=>e.node_id===C);return!e&&c.length>0?c[0]:e},[c,C]),w=(0,I.rW)((null==S?void 0:S.node_id)??null),[A,x]=(0,n.useState)((0,U.Wc)(w,e)),W=(0,n.useRef)(null);(0,u.h)(()=>{var e;null==(e=W.current)||e.select()});let[K,Z]=(0,n.useState)(()=>t??(0,U.WI)(e)),j=function(e){let t=(0,I.BQ)(e.type===y.Z_n.ALIAS?e.value:void 0);return(0,s.Vq)(t)&&"MIXED"!==t?t:null}(K),F=(0,E.C)("fpl_variables_button_migration"),D=(0,n.useMemo)(()=>y.CWU.isValidVariableName(A,(null==S?void 0:S.node_id)??null),[A,null==S?void 0:S.node_id]);async function X(t){if(t){let a=await o((0,_.Oe)(t));Z((0,R.y$)(e,a))}else K.type===y.Z_n.ALIAS&&Z((0,U.WI)(e))}(0,n.useEffect)(()=>{let e=p.current;if(!e)return;let t=e=>e.preventDefault();return e.addEventListener("contextmenu",t),()=>{e.removeEventListener("contextmenu",t)}},[p]);let G=m.of(a,"submit",()=>{i({varName:A,varValue:K,varSetID:(null==S?void 0:S.node_id)??null})});function Y({label:e,input:t}){return n.createElement(h.Y,{spacing:0,horizontalAlignItems:"space-between",height:"hug-contents",padding:{horizontal:B}},n.createElement(V.JU,null,e),t)}return n.createElement("form",{onSubmit:G,autoComplete:"no"},n.createElement(h.Y,{direction:"vertical",spacing:0,height:"hug-contents",ref:p},n.createElement(h.Y,{direction:"vertical",spacing:`${(0,d.jz)(k.dGl)}px`,padding:{top:B},height:"hug-contents"},c.length>0&&!!S&&Y({label:n.createElement(g.Tx,{id:"variables.create_modal.collection_label"}),input:n.createElement("div",{className:P},n.createElement(z,{selectedVariableSetID:S.node_id,variableSets:c,onChange:T}))}),Y({label:n.createElement(g.Tx,{id:"variables.create_modal.name_label"}),input:n.createElement(f.L,{className:"variable_create_modal--textInput--234SQ raw_components--textInput--t9D8g raw_components--base--T7G0z raw_components--input--JB4Ix raw_components--singleRowHeight--dKM4t raw_components--border--SKh2u",name:"variableName",value:A,onChange:e=>{x(e.target.value)},ref:W,recordingKey:m.Pt(a,"variableNameInput"),delay:50,"data-1p-ignore":!0,autoFocus:!0})}),Y({label:n.createElement(g.Tx,{id:"variables.create_modal.value_label"}),input:n.createElement("div",{className:P},n.createElement(N.Cr,{resolvedType:e,variableValue:K,onVariableValueChange:e=>Z(e),onVariableSelected:X},n.createElement(O.g,{variableValue:K,contextType:M.$.FORM,onChange:e=>Z(e),recordingKey:m.Pt(a,"variableValueInput")}),j&&n.createElement(V.K0,{svg:$.A,type:"button","data-tooltip-type":L.Ib.TEXT,"data-tooltip":(0,g.t)("variables.authoring_modal.table.detach_alias"),onClick:()=>Z(j),recordingKey:m.Pt(a,"detachVariableButton")})))}))),n.createElement(h.Y,{horizontalAlignItems:"end",verticalAlignItems:"center",padding:16},F?n.createElement(r.$n,{type:"submit",disabled:!D,recordingKey:m.Pt(a,"createButton"),"data-tooltip-type":D?void 0:L.Ib.TEXT,"data-tooltip":(0,g.t)("variables.create_modal.invalid_variable_name")},n.createElement(g.Tx,{id:"variables.create_modal.create_button"})):n.createElement(b.$$,{style:{justifySelf:"right"},tabIndex:0,type:"submit",disabled:!D,recordingKey:m.Pt(a,"createButton"),"data-tooltip-type":D?void 0:L.Ib.TEXT,"data-tooltip":(0,g.t)("variables.create_modal.invalid_variable_name")},n.createElement("span",null,n.createElement(g.Tx,{id:"variables.create_modal.create_button"})))))}function z({selectedVariableSetID:e,variableSets:t,onChange:a}){let r=(0,l.wA)(),i=(0,T.U)(),c=(0,n.useMemo)(()=>o()(t,e=>e.node_id),[t]);return n.createElement(w.l6,{id:"variable-create-modal-variable-set-select",property:c[e],formatter:{format:e=>(null==e?void 0:e.name)??""},dispatch:r,chevronClassName:"variable_create_modal--variableSetSelectChevron--larcU",inputClassName:"variable_create_modal--variableSetSelectInput--YUE3H",dropdownShown:i,onChange:e=>a(e.node_id)},t.map(function(e){return n.createElement(w.c$,{key:e.node_id,value:e})}))}},293775:(e,t,a)=>{a.d(t,{C:()=>l});var n=a(411855);function l(e){return n.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e},n.createElement("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"m4.7 4.7.315-1.26c.126-.505.844-.505.97 0L6.3 4.7l1.26.315c.505.126.505.844 0 .97L6.3 6.3l-.315 1.26c-.126.505-.844.505-.97 0L4.7 6.3l-1.26-.315c-.505-.126-.505-.844 0-.97L4.7 4.7Zm4.49 4.491 1.117-3.908c.486-1.702 2.898-1.702 3.384 0L14.81 9.19l3.908 1.117c1.702.486 1.702 2.898 0 3.384L14.81 14.81l-1.117 3.908c-.486 1.702-2.898 1.702-3.384 0L9.19 14.81l-3.908-1.117c-1.702-.486-1.702-2.898 0-3.384L9.19 9.19ZM10 10l1.27-4.442c.21-.735 1.25-.735 1.46 0L14 10l4.442 1.27c.735.21.735 1.25 0 1.46L14 14l-1.27 4.442c-.21.735-1.25.735-1.46 0L10 14l-4.442-1.27c-.735-.21-.735-1.25 0-1.46L10 10Zm8.015 6.44L17.7 17.7l-1.26.315c-.505.126-.505.844 0 .97l1.26.315.315 1.26c.126.505.844.505.97 0l.315-1.26 1.26-.315c.505-.126.505-.844 0-.97L19.3 17.7l-.315-1.26c-.126-.505-.844-.505-.97 0Z",clipRule:"evenodd"}))}}}]);

//# debugId=ab40a0f5-2168-5bb5-9b17-a75b6929be41

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/6ce02f1bf75ef994a51de3cb894f13e3cebbeea9/8744-da5d5137f3a48387.min.js.map